// File generated from our OpenAPI spec by Stainless.

package io.stigg.models.v1.subscriptions

import com.fasterxml.jackson.module.kotlin.jacksonTypeRef
import io.stigg.core.JsonValue
import io.stigg.core.jsonMapper
import java.time.OffsetDateTime
import org.assertj.core.api.Assertions.assertThat
import org.junit.jupiter.api.Test

internal class SubscriptionProvisionResponseTest {

    @Test
    fun create() {
        val subscriptionProvisionResponse =
            SubscriptionProvisionResponse.builder()
                .data(
                    SubscriptionProvisionResponse.Data.builder()
                        .id("id")
                        .addEntitlement(
                            SubscriptionProvisionResponse.Data.Entitlement.UnionMember0.builder()
                                .accessDeniedReason(
                                    SubscriptionProvisionResponse.Data.Entitlement.UnionMember0
                                        .AccessDeniedReason
                                        .FEATURE_NOT_FOUND
                                )
                                .isGranted(true)
                                .type(
                                    SubscriptionProvisionResponse.Data.Entitlement.UnionMember0.Type
                                        .FEATURE
                                )
                                .currentUsage(0.0)
                                .entitlementUpdatedAt(
                                    OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                                )
                                .feature(
                                    SubscriptionProvisionResponse.Data.Entitlement.UnionMember0
                                        .Feature
                                        .builder()
                                        .displayName("displayName")
                                        .featureStatus(
                                            SubscriptionProvisionResponse.Data.Entitlement
                                                .UnionMember0
                                                .Feature
                                                .FeatureStatus
                                                .NEW
                                        )
                                        .featureType(
                                            SubscriptionProvisionResponse.Data.Entitlement
                                                .UnionMember0
                                                .Feature
                                                .FeatureType
                                                .BOOLEAN
                                        )
                                        .refId("refId")
                                        .build()
                                )
                                .hasUnlimitedUsage(true)
                                .resetPeriod(
                                    SubscriptionProvisionResponse.Data.Entitlement.UnionMember0
                                        .ResetPeriod
                                        .YEAR
                                )
                                .usageLimit(0.0)
                                .usagePeriodAnchor(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .usagePeriodEnd(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .usagePeriodStart(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .validUntil(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .build()
                        )
                        .status(SubscriptionProvisionResponse.Data.Status.SUCCESS)
                        .subscription(
                            SubscriptionProvisionResponse.Data.Subscription.builder()
                                .id("id")
                                .billingId("billingId")
                                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .customerId("customerId")
                                .paymentCollection(
                                    SubscriptionProvisionResponse.Data.Subscription
                                        .PaymentCollection
                                        .NOT_REQUIRED
                                )
                                .planId("planId")
                                .pricingType(
                                    SubscriptionProvisionResponse.Data.Subscription.PricingType.FREE
                                )
                                .startDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .status(
                                    SubscriptionProvisionResponse.Data.Subscription.Status
                                        .PAYMENT_PENDING
                                )
                                .cancellationDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .cancelReason(
                                    SubscriptionProvisionResponse.Data.Subscription.CancelReason
                                        .UPGRADE_OR_DOWNGRADE
                                )
                                .currentBillingPeriodEnd(
                                    OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                                )
                                .currentBillingPeriodStart(
                                    OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                                )
                                .effectiveEndDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .endDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .metadata(
                                    SubscriptionProvisionResponse.Data.Subscription.Metadata
                                        .builder()
                                        .putAdditionalProperty("foo", JsonValue.from("string"))
                                        .build()
                                )
                                .payingCustomerId("payingCustomerId")
                                .paymentCollectionMethod(
                                    SubscriptionProvisionResponse.Data.Subscription
                                        .PaymentCollectionMethod
                                        .CHARGE
                                )
                                .addPrice(
                                    SubscriptionProvisionResponse.Data.Subscription.Price.builder()
                                        .addonId("addonId")
                                        .baseCharge(true)
                                        .blockSize(0.0)
                                        .featureId("featureId")
                                        .price(
                                            SubscriptionProvisionResponse.Data.Subscription.Price
                                                .InnerPrice
                                                .builder()
                                                .amount(0.0)
                                                .billingCountryCode("billingCountryCode")
                                                .currency(
                                                    SubscriptionProvisionResponse.Data.Subscription
                                                        .Price
                                                        .InnerPrice
                                                        .Currency
                                                        .USD
                                                )
                                                .build()
                                        )
                                        .addTier(
                                            SubscriptionProvisionResponse.Data.Subscription.Price
                                                .Tier
                                                .builder()
                                                .flatPrice(
                                                    SubscriptionProvisionResponse.Data.Subscription
                                                        .Price
                                                        .Tier
                                                        .FlatPrice
                                                        .builder()
                                                        .amount(0.0)
                                                        .billingCountryCode("billingCountryCode")
                                                        .currency(
                                                            SubscriptionProvisionResponse.Data
                                                                .Subscription
                                                                .Price
                                                                .Tier
                                                                .FlatPrice
                                                                .Currency
                                                                .USD
                                                        )
                                                        .build()
                                                )
                                                .unitPrice(
                                                    SubscriptionProvisionResponse.Data.Subscription
                                                        .Price
                                                        .Tier
                                                        .UnitPrice
                                                        .builder()
                                                        .amount(0.0)
                                                        .billingCountryCode("billingCountryCode")
                                                        .currency(
                                                            SubscriptionProvisionResponse.Data
                                                                .Subscription
                                                                .Price
                                                                .Tier
                                                                .UnitPrice
                                                                .Currency
                                                                .USD
                                                        )
                                                        .build()
                                                )
                                                .upTo(0.0)
                                                .build()
                                        )
                                        .build()
                                )
                                .resourceId("resourceId")
                                .trialEndDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .build()
                        )
                        .checkoutBillingId("checkoutBillingId")
                        .checkoutUrl("checkoutUrl")
                        .isScheduled(true)
                        .build()
                )
                .build()

        assertThat(subscriptionProvisionResponse.data())
            .isEqualTo(
                SubscriptionProvisionResponse.Data.builder()
                    .id("id")
                    .addEntitlement(
                        SubscriptionProvisionResponse.Data.Entitlement.UnionMember0.builder()
                            .accessDeniedReason(
                                SubscriptionProvisionResponse.Data.Entitlement.UnionMember0
                                    .AccessDeniedReason
                                    .FEATURE_NOT_FOUND
                            )
                            .isGranted(true)
                            .type(
                                SubscriptionProvisionResponse.Data.Entitlement.UnionMember0.Type
                                    .FEATURE
                            )
                            .currentUsage(0.0)
                            .entitlementUpdatedAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .feature(
                                SubscriptionProvisionResponse.Data.Entitlement.UnionMember0.Feature
                                    .builder()
                                    .displayName("displayName")
                                    .featureStatus(
                                        SubscriptionProvisionResponse.Data.Entitlement.UnionMember0
                                            .Feature
                                            .FeatureStatus
                                            .NEW
                                    )
                                    .featureType(
                                        SubscriptionProvisionResponse.Data.Entitlement.UnionMember0
                                            .Feature
                                            .FeatureType
                                            .BOOLEAN
                                    )
                                    .refId("refId")
                                    .build()
                            )
                            .hasUnlimitedUsage(true)
                            .resetPeriod(
                                SubscriptionProvisionResponse.Data.Entitlement.UnionMember0
                                    .ResetPeriod
                                    .YEAR
                            )
                            .usageLimit(0.0)
                            .usagePeriodAnchor(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .usagePeriodEnd(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .usagePeriodStart(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .validUntil(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .build()
                    )
                    .status(SubscriptionProvisionResponse.Data.Status.SUCCESS)
                    .subscription(
                        SubscriptionProvisionResponse.Data.Subscription.builder()
                            .id("id")
                            .billingId("billingId")
                            .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .customerId("customerId")
                            .paymentCollection(
                                SubscriptionProvisionResponse.Data.Subscription.PaymentCollection
                                    .NOT_REQUIRED
                            )
                            .planId("planId")
                            .pricingType(
                                SubscriptionProvisionResponse.Data.Subscription.PricingType.FREE
                            )
                            .startDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .status(
                                SubscriptionProvisionResponse.Data.Subscription.Status
                                    .PAYMENT_PENDING
                            )
                            .cancellationDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .cancelReason(
                                SubscriptionProvisionResponse.Data.Subscription.CancelReason
                                    .UPGRADE_OR_DOWNGRADE
                            )
                            .currentBillingPeriodEnd(
                                OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                            )
                            .currentBillingPeriodStart(
                                OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                            )
                            .effectiveEndDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .endDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .metadata(
                                SubscriptionProvisionResponse.Data.Subscription.Metadata.builder()
                                    .putAdditionalProperty("foo", JsonValue.from("string"))
                                    .build()
                            )
                            .payingCustomerId("payingCustomerId")
                            .paymentCollectionMethod(
                                SubscriptionProvisionResponse.Data.Subscription
                                    .PaymentCollectionMethod
                                    .CHARGE
                            )
                            .addPrice(
                                SubscriptionProvisionResponse.Data.Subscription.Price.builder()
                                    .addonId("addonId")
                                    .baseCharge(true)
                                    .blockSize(0.0)
                                    .featureId("featureId")
                                    .price(
                                        SubscriptionProvisionResponse.Data.Subscription.Price
                                            .InnerPrice
                                            .builder()
                                            .amount(0.0)
                                            .billingCountryCode("billingCountryCode")
                                            .currency(
                                                SubscriptionProvisionResponse.Data.Subscription
                                                    .Price
                                                    .InnerPrice
                                                    .Currency
                                                    .USD
                                            )
                                            .build()
                                    )
                                    .addTier(
                                        SubscriptionProvisionResponse.Data.Subscription.Price.Tier
                                            .builder()
                                            .flatPrice(
                                                SubscriptionProvisionResponse.Data.Subscription
                                                    .Price
                                                    .Tier
                                                    .FlatPrice
                                                    .builder()
                                                    .amount(0.0)
                                                    .billingCountryCode("billingCountryCode")
                                                    .currency(
                                                        SubscriptionProvisionResponse.Data
                                                            .Subscription
                                                            .Price
                                                            .Tier
                                                            .FlatPrice
                                                            .Currency
                                                            .USD
                                                    )
                                                    .build()
                                            )
                                            .unitPrice(
                                                SubscriptionProvisionResponse.Data.Subscription
                                                    .Price
                                                    .Tier
                                                    .UnitPrice
                                                    .builder()
                                                    .amount(0.0)
                                                    .billingCountryCode("billingCountryCode")
                                                    .currency(
                                                        SubscriptionProvisionResponse.Data
                                                            .Subscription
                                                            .Price
                                                            .Tier
                                                            .UnitPrice
                                                            .Currency
                                                            .USD
                                                    )
                                                    .build()
                                            )
                                            .upTo(0.0)
                                            .build()
                                    )
                                    .build()
                            )
                            .resourceId("resourceId")
                            .trialEndDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .build()
                    )
                    .checkoutBillingId("checkoutBillingId")
                    .checkoutUrl("checkoutUrl")
                    .isScheduled(true)
                    .build()
            )
    }

    @Test
    fun roundtrip() {
        val jsonMapper = jsonMapper()
        val subscriptionProvisionResponse =
            SubscriptionProvisionResponse.builder()
                .data(
                    SubscriptionProvisionResponse.Data.builder()
                        .id("id")
                        .addEntitlement(
                            SubscriptionProvisionResponse.Data.Entitlement.UnionMember0.builder()
                                .accessDeniedReason(
                                    SubscriptionProvisionResponse.Data.Entitlement.UnionMember0
                                        .AccessDeniedReason
                                        .FEATURE_NOT_FOUND
                                )
                                .isGranted(true)
                                .type(
                                    SubscriptionProvisionResponse.Data.Entitlement.UnionMember0.Type
                                        .FEATURE
                                )
                                .currentUsage(0.0)
                                .entitlementUpdatedAt(
                                    OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                                )
                                .feature(
                                    SubscriptionProvisionResponse.Data.Entitlement.UnionMember0
                                        .Feature
                                        .builder()
                                        .displayName("displayName")
                                        .featureStatus(
                                            SubscriptionProvisionResponse.Data.Entitlement
                                                .UnionMember0
                                                .Feature
                                                .FeatureStatus
                                                .NEW
                                        )
                                        .featureType(
                                            SubscriptionProvisionResponse.Data.Entitlement
                                                .UnionMember0
                                                .Feature
                                                .FeatureType
                                                .BOOLEAN
                                        )
                                        .refId("refId")
                                        .build()
                                )
                                .hasUnlimitedUsage(true)
                                .resetPeriod(
                                    SubscriptionProvisionResponse.Data.Entitlement.UnionMember0
                                        .ResetPeriod
                                        .YEAR
                                )
                                .usageLimit(0.0)
                                .usagePeriodAnchor(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .usagePeriodEnd(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .usagePeriodStart(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .validUntil(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .build()
                        )
                        .status(SubscriptionProvisionResponse.Data.Status.SUCCESS)
                        .subscription(
                            SubscriptionProvisionResponse.Data.Subscription.builder()
                                .id("id")
                                .billingId("billingId")
                                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .customerId("customerId")
                                .paymentCollection(
                                    SubscriptionProvisionResponse.Data.Subscription
                                        .PaymentCollection
                                        .NOT_REQUIRED
                                )
                                .planId("planId")
                                .pricingType(
                                    SubscriptionProvisionResponse.Data.Subscription.PricingType.FREE
                                )
                                .startDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .status(
                                    SubscriptionProvisionResponse.Data.Subscription.Status
                                        .PAYMENT_PENDING
                                )
                                .cancellationDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .cancelReason(
                                    SubscriptionProvisionResponse.Data.Subscription.CancelReason
                                        .UPGRADE_OR_DOWNGRADE
                                )
                                .currentBillingPeriodEnd(
                                    OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                                )
                                .currentBillingPeriodStart(
                                    OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                                )
                                .effectiveEndDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .endDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .metadata(
                                    SubscriptionProvisionResponse.Data.Subscription.Metadata
                                        .builder()
                                        .putAdditionalProperty("foo", JsonValue.from("string"))
                                        .build()
                                )
                                .payingCustomerId("payingCustomerId")
                                .paymentCollectionMethod(
                                    SubscriptionProvisionResponse.Data.Subscription
                                        .PaymentCollectionMethod
                                        .CHARGE
                                )
                                .addPrice(
                                    SubscriptionProvisionResponse.Data.Subscription.Price.builder()
                                        .addonId("addonId")
                                        .baseCharge(true)
                                        .blockSize(0.0)
                                        .featureId("featureId")
                                        .price(
                                            SubscriptionProvisionResponse.Data.Subscription.Price
                                                .InnerPrice
                                                .builder()
                                                .amount(0.0)
                                                .billingCountryCode("billingCountryCode")
                                                .currency(
                                                    SubscriptionProvisionResponse.Data.Subscription
                                                        .Price
                                                        .InnerPrice
                                                        .Currency
                                                        .USD
                                                )
                                                .build()
                                        )
                                        .addTier(
                                            SubscriptionProvisionResponse.Data.Subscription.Price
                                                .Tier
                                                .builder()
                                                .flatPrice(
                                                    SubscriptionProvisionResponse.Data.Subscription
                                                        .Price
                                                        .Tier
                                                        .FlatPrice
                                                        .builder()
                                                        .amount(0.0)
                                                        .billingCountryCode("billingCountryCode")
                                                        .currency(
                                                            SubscriptionProvisionResponse.Data
                                                                .Subscription
                                                                .Price
                                                                .Tier
                                                                .FlatPrice
                                                                .Currency
                                                                .USD
                                                        )
                                                        .build()
                                                )
                                                .unitPrice(
                                                    SubscriptionProvisionResponse.Data.Subscription
                                                        .Price
                                                        .Tier
                                                        .UnitPrice
                                                        .builder()
                                                        .amount(0.0)
                                                        .billingCountryCode("billingCountryCode")
                                                        .currency(
                                                            SubscriptionProvisionResponse.Data
                                                                .Subscription
                                                                .Price
                                                                .Tier
                                                                .UnitPrice
                                                                .Currency
                                                                .USD
                                                        )
                                                        .build()
                                                )
                                                .upTo(0.0)
                                                .build()
                                        )
                                        .build()
                                )
                                .resourceId("resourceId")
                                .trialEndDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .build()
                        )
                        .checkoutBillingId("checkoutBillingId")
                        .checkoutUrl("checkoutUrl")
                        .isScheduled(true)
                        .build()
                )
                .build()

        val roundtrippedSubscriptionProvisionResponse =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(subscriptionProvisionResponse),
                jacksonTypeRef<SubscriptionProvisionResponse>(),
            )

        assertThat(roundtrippedSubscriptionProvisionResponse)
            .isEqualTo(subscriptionProvisionResponse)
    }
}
